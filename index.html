<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ADB Backup æŒ‡ä»¤ç”¢ç”Ÿå™¨ V_1141106</title>
<style>
body {
  background: #0b1020;
  color: #e6ebff;
  font-family: "Microsoft JhengHei", sans-serif;
  margin: 0;
  height: 100vh;
  display: flex;
  flex-direction: column;
}
header {
  padding: 12px 20px;
  background: #11182a;
  border-bottom: 1px solid #2b355a;
  font-size: 20px;
  font-weight: bold;
}
main {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow-y: auto;
  padding: 20px;
}
.section {
  display: flex;
  gap: 16px;
  margin-bottom: 20px;
  background: #11182a;
  border: 1px solid #2b355a;
  border-radius: 10px;
  padding: 16px;
}
.left { width: 45%; }
.right { flex: 1; display: flex; flex-direction: column; }
h2 { font-size: 16px; color: #a7b6de; margin-bottom: 6px; }
label { display: block; margin: 4px 0; cursor: pointer; }
textarea {
  width: 100%;
  flex: 1;
  border-radius: 8px;
  border: 1px solid #2b355a;
  background: #0c1020;
  color: #dfe6ff;
  padding: 12px;
  font-family: Consolas, monospace;
  font-size: 13px;
  resize: none;
}
button {
  margin-top: 10px;
  padding: 8px 14px;
  background: #17603a;
  border: none;
  color: #fff;
  border-radius: 6px;
  font-weight: bold;
  cursor: pointer;
  align-self: flex-end;
}
input[type="text"] {
  width: 42%;
  padding: 6px;
  margin-right: 4px;
  border: 1px solid #2b355a;
  border-radius: 6px;
  background: #0c1020;
  color: #fff;
}
.add-row {
  background: #2b355a;
  border: none;
  color: #fff;
  padding: 4px 10px;
  border-radius: 6px;
  cursor: pointer;
  font-weight: bold;
  margin-top: 6px;
}
</style>
</head>
<body>
<header>ADB Backup æŒ‡ä»¤ç”¢ç”Ÿå™¨</header>
<main>

<!-- ç¬¬ä¸€å€æ®µ -->
<div class="section">
  <div class="left">
    <h2>1ï¸âƒ£ åˆå§‹åŒ–èˆ‡è£ç½®è³‡è¨Š</h2>
    <label><input type="checkbox" id="chkModel" checked> è£ç½®å‹è™Ÿï¼ˆro.product.modelï¼‰</label>
    <label><input type="checkbox" id="chkSerial" checked> åºè™Ÿï¼ˆro.serialnoï¼‰</label>
  </div>
  <div class="right">
    <textarea id="outInfo" readonly></textarea>
    <button id="copyInfo">ğŸ“‹ è¤‡è£½æ­¤å€æ®µ</button>
  </div>
</div>

<!-- ç¬¬äºŒå€æ®µ -->
<div class="section">
  <div class="left">
    <h2>2ï¸âƒ£ åˆ—å‡ºæ‰€æœ‰å·²å®‰è£ App</h2>
    <p>é¡¯ç¤ºè£ç½®ä¸­æ‰€æœ‰å¥—ä»¶ï¼š</p>
  </div>
  <div class="right">
    <textarea id="outList" readonly></textarea>
    <button id="copyList">ğŸ“‹ è¤‡è£½æ­¤å€æ®µ</button>
  </div>
</div>

<!-- ç¬¬ä¸‰å€æ®µ -->
<div class="section">
  <div class="left">
    <h2>3ï¸âƒ£ æ‰“åŒ…å¸¸è¦‹ App ä¸¦ä¸‹è¼‰è‡³ç•¶å‰è³‡æ–™å¤¾</h2>
    <label><input type="checkbox" class="app" data-bundle="jp.naver.line.android"> LINE</label>
    <label><input type="checkbox" class="app" data-bundle="org.telegram.messenger"> Telegram</label>
    <label><input type="checkbox" class="app" data-bundle="com.tencent.mm"> WeChat</label>
    <label><input type="checkbox" class="app" data-bundle="com.facebook.katana"> Facebook</label>
    <label><input type="checkbox" class="app" data-bundle="com.instagram.android"> Instagram</label>
    <label><input type="checkbox" class="app" data-bundle="com.instagram.threadsapp"> Threads</label>
    <label><input type="checkbox" class="app" data-bundle="com.twitter.android"> Xï¼ˆTwitterï¼‰</label>

    <h3 style="margin-top:10px; color:#a7b6de;">â• è‡ªå®šç¾©æ‰“åŒ…é …ç›®</h3>
    <div id="customList"></div>
    <button class="add-row" id="addRow">ï¼‹ æ–°å¢ä¸€ç­†</button>
  </div>
  <div class="right">
    <textarea id="outPull" readonly></textarea>
    <button id="copyPull">ğŸ“‹ è¤‡è£½æ­¤å€æ®µ</button>
  </div>
</div>

<!-- æ•´åˆå€ -->
<div class="section">
  <div class="left">
    <h2>ğŸ§¾ æ•´åˆè¤‡è£½ï¼ˆå–®è¡ŒåŸ·è¡Œï¼‰</h2>
  </div>
  <div class="right">
    <textarea id="outAll" readonly></textarea>
    <button id="copyAll">ğŸ“‹ è¤‡è£½æ•´åˆæŒ‡ä»¤</button>
  </div>
</div>

</main>

<script>
const $=s=>document.querySelector(s);
function buildInfo(){
  const cmds=["adb kill-server","adb start-server","adb devices"];
  if($('#chkModel').checked) cmds.push("adb shell getprop ro.product.model");
  if($('#chkSerial').checked) cmds.push("adb shell getprop ro.serialno");
  return cmds.join(" && ");
}
function buildList(){
  return "adb shell pm list packages";
}
function buildPull(){
  const cmds=[];
  document.querySelectorAll('.app:checked').forEach(a=>{
    const name=a.nextSibling.textContent.trim().replace(/[()]/g,'');
    const bundle=a.dataset.bundle;
    cmds.push(`adb shell "su -c 'tar -cf /sdcard/${name.toLowerCase()}_backup.tar /data/data/${bundle}/'" && adb pull /sdcard/${name.toLowerCase()}_backup.tar .\\`);
  });
  document.querySelectorAll('.custom-row').forEach(r=>{
    const name=r.querySelector('.cname').value.trim();
    const bundle=r.querySelector('.cbundle').value.trim();
    if(name && bundle)
      cmds.push(`adb shell "su -c 'tar -cf /sdcard/${name}_backup.tar /data/data/${bundle}/'" && adb pull /sdcard/${name}_backup.tar .\\`);
  });
  return cmds.join(" && ");
}
function updateAll(){
  const info=buildInfo(), list=buildList(), pull=buildPull();
  $('#outInfo').value=info;
  $('#outList').value=list;
  $('#outPull').value=pull;
  $('#outAll').value=[info,list,pull].filter(Boolean).join(" && ");
}
function addCustomRow(){
  const div=document.createElement('div');
  div.className='custom-row';
  div.innerHTML=`<input type="text" class="cname" placeholder="å­˜æª”åç¨±"> <input type="text" class="cbundle" placeholder="Bundle åç¨±">`;
  $('#customList').appendChild(div);
  div.querySelectorAll('input').forEach(i=>i.addEventListener('input',updateAll));
}
$('#addRow').onclick=()=>{addCustomRow();updateAll();};
document.querySelectorAll('input').forEach(el=>el.addEventListener('input',updateAll));
document.querySelectorAll('input').forEach(el=>el.addEventListener('change',updateAll));
async function copy(id,btn){
  const txt=$(id).value.trim(); if(!txt) return;
  await navigator.clipboard.writeText(txt);
  $(btn).textContent='âœ… å·²è¤‡è£½';
  setTimeout(()=>$(btn).textContent='ğŸ“‹ è¤‡è£½',1000);
}
$('#copyInfo').onclick=()=>copy('#outInfo','#copyInfo');
$('#copyList').onclick=()=>copy('#outList','#copyList');
$('#copyPull').onclick=()=>copy('#outPull','#copyPull');
$('#copyAll').onclick=()=>copy('#outAll','#copyAll');
updateAll();
</script>
</body>
</html>
